<%- include('./header.ejs', {Env: Env}); %>
<body>
    <%- include('./navbar.ejs', {Env: Env}); %>
    

<div id="container" class="container">
		<nav aria-label="パンくずリスト">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="<%= Env.https_path %>">ホーム</a></li>
				<li class="breadcrumb-item">新規予約(人数選択)</li>
				<li class="breadcrumb-item active" aria-current="page">新規予約(日付選択)</li>
			</ol>
		</nav>
	<div class="jumbotron">
	<h2>予約日時の選択</h2>
		<ul>
            <li>予約人数: <strong><%= form.num%></strong>人<br/>
                <% families.forEach(function(family){ %>
                    <%= family.name %>様<br/>
                <% }); %>
            </li>
            <li>予約したい日付、時間帯を選択してください。</li>
    	</ul>
	<form action="<%= Env.https_path %>" method="get">
        <input type="hidden" name="mode" value="reservenewcal" />
        <input type="hidden" name="plan" value="<%= form.plan%>" />
        <input type="hidden" name="num" value="<%= form.num%>" />
        <% ptuids.forEach(function(ptuid){ %>
            <input type="hidden" name="ptuids[]" value="<%= ptuid%>" />
        <% }); %>
        <div class="form-inline">
            <select name="yearmonth"  id="select_year"  class="form-control" >
            <% yearmonths.forEach(function(ym){ %>
                <option value="<%= ym.id %>"<% if(ym.flag){ %> selected="selected"<% } %>><%= ym.name %></option>
            <% }); %>
            </select>
        </div>
	</form>
	<h3><%= form.year %>年<%= form.month %>月の空き状況</h3>
	<table summary="利用日一覧" class="table table-bordered table-responsive-sm">
		<tr>
			<th class="table-danger">日</th>
			<th class="table-light">月</th>
			<th class="table-light">火</th>
			<th class="table-light">水</th>
			<th class="table-light">木</th>
			<th class="table-light">金</th>
			<th class="table-primary">土</th>
		</tr>
        <% calenders.forEach(function(calender, index){ %>
		    <% if(index % 7 == 0){ %>
			    <tr>
            <% } %>
			<% if(calender.type == ''){ %>
    			<td>-</td>
            <% } else { %>
				<% if(calender.type == 'day'){ %>
					<td class="table-light">
				<% } else if(calender.type == 'satday') { %>
					<td  class="table-primary">
				<% } else if(calender.type == 'sunday') { %>
					<td  class="table-danger">
				<% } %>

				<%= calender.day%><br/>
				<% if(calender.available == false) { %>×
				<% } else { %> 
					<% calender.zns.forEach(function(zn){ %>
						<% if(zn.num >= 0){ %>
							<a href="<%= Env.https_path %>?mode=reservenewconf&amp;plan=<%= form.plan%>&amp;year=<%= form.year%>&amp;month=<%= form.month%>&amp;day=<%= calender.day%>&amp;num=<%= form.num%>&amp;zoneid=<%=zn.zoneid%><% ptuids.forEach(function(ptuid){ %>&amp;ptuids%5b%5d=<%= ptuid %><% }); %>"><%=zn.zonename.slice(0,2)%>:○</a><br/>
						<% } else { %>
							<%=zn.zonename.slice(0,2)%>:×<br/>
						<% } %>
					<% }); %>
				<% } %>
				</td>
            <% } %>
    			
            <% if(index % 7 == 6){ %>
                </tr>
            <% } %>
        <% } ); //foreach %>
	</table>
    <div id="navi" class="form-group">
        <%# <a href="= Env.https_path ?mode=reservenew&amp;plan= form.plan " class="btn btn-info m-1"  role="button" id="backbtn">戻る</a> %>
        <a href="#" class="btn btn-info m-1"  role="button" id="backbtn">戻る</a>
    </div>
</div>
<%- include('./footer.ejs'); %>

</body>

</html>